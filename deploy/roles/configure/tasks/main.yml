# Configure the box. This happens after the base initialization, but before
# the project is cloned or built.

- name: set hostname
  hostname: name={{ hostname }}

- name: add loopback references to our domains in /etc/hosts
  lineinfile:
    dest: /etc/hosts
    state: present
    line: 127.0.0.1 {{ hostname }} {{ item }}
  with_items:
    - '{{ site.fqdn }}'

- name: allow passwordless sudo - development only!
  lineinfile:
    dest: /etc/sudoers
    state: present
    regexp: ^%sudo
    line: "%sudo\tALL=(ALL:ALL) NOPASSWD:ALL" # Must be double-quotes for escaping
    validate: visudo -cf %s
  when: env == 'development'
